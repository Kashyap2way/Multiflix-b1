{"version":3,"file":"sendEmailMultipleRecipients.js","sourceRoot":"","sources":["../../samples-dev/sendEmailMultipleRecipients.ts"],"names":[],"mappings":"AAAA,uCAAuC;AACvC,kCAAkC;AAElC;;GAEG;AAEH,OAAO,EAAE,WAAW,EAAgB,MAAM,4BAA4B,CAAC;AAEvE,wEAAwE;AACxE,OAAO,KAAK,MAAM,MAAM,QAAQ,CAAC;AACjC,MAAM,CAAC,MAAM,EAAE,CAAC;AAEhB,MAAM,gBAAgB,GAAG,OAAO,CAAC,GAAG,CAAC,iCAAiC,CAAC,IAAI,EAAE,CAAC;AAC9E,MAAM,aAAa,GAAG,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;AAC1D,MAAM,gBAAgB,GAAG,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,IAAI,EAAE,CAAC;AAChE,MAAM,sBAAsB,GAAG,OAAO,CAAC,GAAG,CAAC,0BAA0B,CAAC,IAAI,EAAE,CAAC;AAE7E,MAAM,2BAA2B,GAAG,KAAK,IAAmB,EAAE;IAC5D,0BAA0B;IAC1B,MAAM,WAAW,GAAgB,IAAI,WAAW,CAAC,gBAAgB,CAAC,CAAC;IAEnE,sCAAsC;IACtC,MAAM,OAAO,GAAiB;QAC5B,aAAa,EAAE,aAAa;QAC5B,OAAO,EAAE;YACP,OAAO,EAAE,qBAAqB;YAC9B,SAAS,EAAE,kBAAkB;YAC7B,IAAI,EAAE,wCAAwC;SAC/C;QACD,UAAU,EAAE;YACV,EAAE,EAAE;gBACF,EAAE,OAAO,EAAE,gBAAgB,EAAE,WAAW,EAAE,eAAe,EAAE;gBAC3D,EAAE,OAAO,EAAE,sBAAsB,EAAE,WAAW,EAAE,iBAAiB,EAAE;aACpE;YACD,EAAE,EAAE,CAAC,EAAE,OAAO,EAAE,gBAAgB,EAAE,WAAW,EAAE,eAAe,EAAE,CAAC;YACjE,GAAG,EAAE,CAAC,EAAE,OAAO,EAAE,sBAAsB,EAAE,WAAW,EAAE,iBAAiB,EAAE,CAAC;SAC3E;KACF,CAAC;IAEF,IAAI;QACF,yBAAyB;QACzB,MAAM,MAAM,GAAG,MAAM,WAAW,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QACpD,MAAM,QAAQ,GAAG,MAAM,MAAM,CAAC,aAAa,EAAE,CAAC;QAE9C,0FAA0F;QAC1F,OAAO,CAAC,GAAG,CAAC,gBAAgB,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAC;KAC7C;IAAC,OAAO,KAAK,EAAE;QACd,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;KACpB;AACH,CAAC,CAAC;AAEF,KAAK,2BAA2B,EAAE,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\n/**\n * @summary Sends an email with multiple recipients\n */\n\nimport { EmailClient, EmailMessage } from \"@azure/communication-email\";\n\n// Load the .env file (you will need to set these environment variables)\nimport * as dotenv from \"dotenv\";\ndotenv.config();\n\nconst connectionString = process.env[\"COMMUNICATION_CONNECTION_STRING\"] || \"\";\nconst senderAddress = process.env[\"SENDER_ADDRESS\"] || \"\";\nconst recipientAddress = process.env[\"RECIPIENT_ADDRESS\"] || \"\";\nconst secondRecipientAddress = process.env[\"SECOND_RECIPIENT_ADDRESS\"] || \"\";\n\nconst sendEmailMultipleRecipients = async (): Promise<void> => {\n  // Create the Email Client\n  const emailClient: EmailClient = new EmailClient(connectionString);\n\n  // Create the Email Message to be sent\n  const message: EmailMessage = {\n    senderAddress: senderAddress,\n    content: {\n      subject: \"This is the subject\",\n      plainText: \"This is the body\",\n      html: \"<html><h1>This is the body</h1></html>\",\n    },\n    recipients: {\n      to: [\n        { address: recipientAddress, displayName: \"Customer Name\" },\n        { address: secondRecipientAddress, displayName: \"Customer Name 2\" },\n      ],\n      cc: [{ address: recipientAddress, displayName: \"Customer Name\" }],\n      bcc: [{ address: secondRecipientAddress, displayName: \"Customer Name 2\" }],\n    },\n  };\n\n  try {\n    // Send the email message\n    const poller = await emailClient.beginSend(message);\n    const response = await poller.pollUntilDone();\n\n    // Get the OperationId so that it can be used for tracking the message for troubleshooting\n    console.log(\"Operation ID: \" + response.id);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nvoid sendEmailMultipleRecipients();\n"]}